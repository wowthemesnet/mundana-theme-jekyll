<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>What's inside Pytorch Operator? | SpellOnYou</title>

    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>What‚Äôs inside Pytorch Operator? | SpellOnYou</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="What‚Äôs inside Pytorch Operator?" />
<meta name="author" content="dionne" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="What‚Äôs inside Pytorch Operator?" />
<meta property="og:description" content="What‚Äôs inside Pytorch Operator?" />
<link rel="canonical" href="http://localhost:4000/2020/03/note08-fastai-2/" />
<meta property="og:url" content="http://localhost:4000/2020/03/note08-fastai-2/" />
<meta property="og:site_name" content="SpellOnYou" />
<meta property="og:image" content="http://localhost:4000/assets/images/30.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-02T00:00:00+01:00" />
<script type="application/ld+json">
{"description":"What‚Äôs inside Pytorch Operator?","author":{"@type":"Person","name":"dionne"},"@type":"BlogPosting","url":"http://localhost:4000/2020/03/note08-fastai-2/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"dionne"},"image":"http://localhost:4000/assets/images/30.png","headline":"What‚Äôs inside Pytorch Operator?","dateModified":"2020-03-02T00:00:00+01:00","datePublished":"2020-03-02T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2020/03/note08-fastai-2/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


    <link rel="shortcut icon" type="image/x-icon" href="/assets/images/favicon.ico">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

    <!-- Google Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro&display=swap" rel="stylesheet">
<!-- :400,400i,700 -->
    <!-- Bootstrap Modified -->
    <link rel="stylesheet" href="/assets/css/main.css">

    <!-- Theme Stylesheet -->
    <link rel="stylesheet" href="/assets/css/theme.css">

    <!-- Jquery on header to make sure everything works, the rest  of the scripts in footer for fast loading -->
    <script
    src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
    crossorigin="anonymous"></script>

    <!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<!-- This goes before </head> closing tag, Google Analytics can be placed here --> 


</head>

<body class="">

    <!-- Navbar -->
    <nav id="MagicMenu" class="topnav navbar navbar-expand-lg navbar-light bg-white fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/index.html"><strong>SpellOnYou</strong></a>
        <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse" id="navbarColor02" style="">
            <ul class="navbar-nav mr-auto d-flex align-items-center">
               <!--  Replace menu links here -->

<li class="nav-item">
<a class="nav-link" href="/index.html">Home</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/authors-list.html">Authors</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/contact.html">Contact</a>
</li>
<li class="nav-item">
<a class="nav-link" href="/categories.html">Categories</a>
</li>
<!-- <li class="nav-item">
<a target="_blank" class="nav-link" href="https://www.wowthemes.net/themes/mundana-ghost/">Ghost</a>
</li> -->
<li class="nav-item">
<a class="nav-link" href="/resume.html">Resume <i class="fa fa-coffee text-danger"></i></a>
</li>

            </ul>
            <ul class="navbar-nav ml-auto d-flex align-items-center">
                <script src="/assets/js/lunr.js"></script>

<script>
$(function() {
    $("#lunrsearchresults").on('click', '#btnx', function () {
        $('#lunrsearchresults').hide( 1000 );
        $( "body" ).removeClass( "modal-open" );
    });
});
    

var documents = [{
    "id": 0,
    "url": "http://localhost:4000/404/",
    "title": "",
    "body": " 404 Page not found :(  The requested page could not be found. "
    }, {
    "id": 1,
    "url": "http://localhost:4000/about.html",
    "title": "About",
    "body": "Made with by Dionne @karma_Aleph. "
    }, {
    "id": 2,
    "url": "http://localhost:4000/author-dionne.html",
    "title": "dionne",
    "body": "                        {{page. title}} Follow:         {{ site. authors. dionne. site }}         {{ site. authors. dionne. bio }}                                   Posts by {{page. title}}:       {% assign posts = site. posts | where: author , dionne  %}      {% for post in posts %}      {% include main-loop-card. html %}      {% endfor %}  "
    }, {
    "id": 3,
    "url": "http://localhost:4000/authors-list.html",
    "title": "Authors",
    "body": "{{page. title}}:     {% for author in site. authors %}                                           {{ author[1]. name }} | jiwon kim :       (View Posts)      {{ author[1]. bio }}                          &nbsp;       &nbsp;                                    {% endfor %}  "
    }, {
    "id": 4,
    "url": "http://localhost:4000/categories.html",
    "title": "Categories",
    "body": "          Categories          {% for category in site. categories %}     {{ category[0] }}:           {% assign pages_list = category[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 5,
    "url": "http://localhost:4000/contact.html",
    "title": "Contact",
    "body": "  Please send your message to {{site. name}}. I will reply as soon as possible!   "
    }, {
    "id": 6,
    "url": "http://localhost:4000/",
    "title": "Jiwon Kim | Dionne Blog",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 7,
    "url": "http://localhost:4000/privacy-policy.html",
    "title": "Privacy Policy",
    "body": "‚Äù{{site. name}}‚Äù takes your privacy seriously. To better protect your privacy we provide this privacy policy notice explaining the way your personal information is collected and used. Collection of Routine Information: This website track basic information about their visitors. This information includes, but is not limited to, IP addresses, browser details, timestamps and referring pages. None of this information can personally identify specific visitor to this website. The information is tracked for routine administration and maintenance purposes. Cookies: Where necessary, this website uses cookies to store information about a visitor‚Äôs preferences and history in order to better serve the visitor and/or present the visitor with customized content. Advertisement and Other Third Parties: Advertising partners and other third parties may use cookies, scripts and/or web beacons to track visitor activities on this website in order to display advertisements and other useful information. Such tracking is done directly by the third parties through their own servers and is subject to their own privacy policies. This website has no access or control over these cookies, scripts and/or web beacons that may be used by third parties. Learn how to opt out of Google‚Äôs cookie usage. Links to Third Party Websites: We have included links on this website for your use and reference. We are not responsible for the privacy policies on these websites. You should be aware that the privacy policies of these websites may differ from our own. Security: The security of your personal information is important to us, but remember that no method of transmission over the Internet, or method of electronic storage, is 100% secure. While we strive to use commercially acceptable means to protect your personal information, we cannot guarantee its absolute security. Changes To This Privacy Policy: This Privacy Policy is effective and will remain in effect except with respect to any changes in its provisions in the future, which will be in effect immediately after being posted on this page. We reserve the right to update or change our Privacy Policy at any time and you should check this Privacy Policy periodically. If we make any material changes to this Privacy Policy, we will notify you either through the email address you have provided us, or by placing a prominent notice on our website. Contact Information: For any questions or concerns regarding the privacy policy, please contact us here. "
    }, {
    "id": 8,
    "url": "http://localhost:4000/resume.html",
    "title": "Resume",
    "body": "See Resume at google Docs "
    }, {
    "id": 9,
    "url": "http://localhost:4000/tags.html",
    "title": "Tags",
    "body": "          Tags          {% for tag in site. tags %}     {{ tag[0] }}:           {% assign pages_list = tag[1] %}    {% for post in pages_list %}    {% if post. title != null %}     {% if group == null or group == post. group %}           {% include main-loop-card. html %}     {% endif %}    {% endif %}    {% endfor %}    {% assign pages_list = nil %}    {% assign group = nil %}    {% endfor %}                  {% include sidebar-featured. html %}          "
    }, {
    "id": 10,
    "url": "http://localhost:4000/robots.txt",
    "title": "",
    "body": "      Sitemap: {{ ‚Äúsitemap. xml‚Äù   absolute_url }}   "
    }, {
    "id": 11,
    "url": "http://localhost:4000/page2/",
    "title": "Jiwon Kim | Dionne Blog",
    "body": "  {% if page. url ==  /  %}            {% assign latest_post = site. posts[0] %}          &lt;div class= topfirstimage  style= background-image: url({% if latest_post. image contains  ://  %}{{ latest_post. image }}{% else %} {{site. baseurl}}/{{ latest_post. image}}{% endif %}); height: 200px;  background-size: cover;  background-repeat: no-repeat; &gt;&lt;/div&gt;           {{ latest_post. title }}  :       {{ latest_post. excerpt | strip_html | strip_newlines | truncate: 136 }}               In         {% for category in latest_post. categories %}        {{ category }},         {% endfor %}                                {{ latest_post. date | date: '%b %d, %Y' }}                            {%- assign second_post = site. posts[1] -%}                        {% if second_post. image %}                         &lt;img class= w-100  src= {% if second_post. image contains  ://  %}{{ second_post. image }}{% else %}{{ second_post. image | absolute_url }}{% endif %}  alt= {{ second_post. title }} &gt;                        {% endif %}                                    {{ second_post. title }}          :                       In             {% for category in second_post. categories %}            {{ category }},             {% endfor %}                                                      {{ second_post. date | date: '%b %d, %Y' }}                                    {%- assign third_post = site. posts[2] -%}                        {% if third_post. image %}                         &lt;img class= w-100  src= {% if third_post. image contains  ://  %}{{ third_post. image }}{% else %}{{site. baseurl}}/{{ third_post. image }}{% endif %}  alt= {{ third_post. title }} &gt;                        {% endif %}                                    {{ third_post. title }}          :                       In             {% for category in third_post. categories %}            {{ category }},             {% endfor %}                                                      {{ third_post. date | date: '%b %d, %Y' }}                                    {%- assign fourth_post = site. posts[3] -%}                        {% if fourth_post. image %}                        &lt;img class= w-100  src= {% if fourth_post. image contains  ://  %}{{ fourth_post. image }}{% else %}{{site. baseurl}}/{{ fourth_post. image }}{% endif %}  alt= {{ fourth_post. title }} &gt;                        {% endif %}                                    {{ fourth_post. title }}          :                       In             {% for category in fourth_post. categories %}            {{ category }},             {% endfor %}                                                      {{ fourth_post. date | date: '%b %d, %Y' }}                                  {% for post in site. posts %} {% if post. tags contains  sticky  %}                    {{post. title}}                  {{ post. excerpt | strip_html | strip_newlines | truncate: 136 }}                 Read More            	             {% endif %}{% endfor %}  {% endif %}                All Stories:         {% for post in paginator. posts %}          {% include main-loop-card. html %}        {% endfor %}                   {% if paginator. total_pages &gt; 1 %}              {% if paginator. previous_page %}        &laquo; Prev       {% else %}        &laquo;       {% endif %}       {% for page in (1. . paginator. total_pages) %}        {% if page == paginator. page %}        {{ page }}        {% elsif page == 1 %}        {{ page }}        {% else %}        {{ page }}        {% endif %}       {% endfor %}       {% if paginator. next_page %}        Next &raquo;       {% else %}        &raquo;       {% endif %}            {% endif %}                     {% include sidebar-featured. html %}      "
    }, {
    "id": 12,
    "url": "http://localhost:4000/2020/03/note08-fastai-2/",
    "title": "What's inside Pytorch Operator?",
    "body": "2020/03/02 - What‚Äôs inside Pytorch Operator?: Section02 Time comparison with pure Python:    Matmul with broadcasting&gt; 3194. 95 times faster     Einstein summation&gt; 16090. 91 times faster     Pytorch‚Äôs operator&gt; 49166. 67 times faster  1. Elementwise op: 1. 1 Frobenius norm:   above converted into (m*m). sum(). sqrt() Plus, don‚Äôt suffer from mathmatical symbols. He also copy and paste that equations from wikipedia.  and if you need latex form, download it from archive. 2. Elementwise Matmul:  What is the meaning of elementwise?   We do not calculate each component. But all of the component at once. Because, length of column of A and row of B are fixed.   How much time we saved?  So now that takes 1. 37ms. We have removed one line of code and it is a 178 times faster‚Ä¶#TODOI don‚Äôt know where the 5 from. but keep it. Maybe this is related with frobenius norm‚Ä¶?as a result, the code before for k in range(ac):  c[i,j] += a[i,k] + b[k,j]the code after c[i,j] = (a[i,:] * b[:,j]). sum()To compare it (result betweet original and adjusted version) we use not test_eq but other function. The reason for this is that due to rounding errors from math operations, matrices may not be exactly the same. As a result, we want a function that will ‚Äúis a equal to b within some tolerance‚Äù #exportdef near(a,b):   return torch. allclose(a, b, rtol=1e-3, atol=1e-5)def test_near(a,b):   test(a,b,near)test_near(t1, matmul(m1, m2))3. Broadcasting:  Now, we will use the broadcasting and removec[i,j] = (a[i,:] * b[:,j]). sum() How it works?&gt;&gt;&gt; a=tensor([[10,10,10],     [20,20,20],     [30,30,30]])&gt;&gt;&gt; b=tensor([1,2,3,])&gt;&gt;&gt; a,b  (tensor([[10, 10, 10],     [20, 20, 20],     [30, 30, 30]]),tensor([1, 2, 3]))     &gt;&gt;&gt; a+btensor([[11, 12, 13],    [21, 22, 23],    [31, 32, 33]])  &lt;Figure 2&gt; demonstrated how array b is broadcasting(or copied but not occupy memory) to compatible with a. Refered from numpy_tutorial   there is no loop, but it seems there is exactly the loop.     This is not from jeremy (actually after a moment he cover it) but i wondered How to broadcast an array by columns?  c=tensor([[1],[2],[3]])a+ctensor([[11, 11, 11],    [22, 22, 22],    [33, 33, 33]])s  What is tensor. stride()?help(t. stride)Help on built-in function stride:  stride(‚Ä¶) method of torch. Tensor instancestride(dim) -&gt; tuple or intReturns the stride of :attr:‚Äôself‚Äô tensor. Stride is the jump necessary to go from one element to the next one in the specified dimension :attr:‚Äôdim‚Äô. A tuple of all strides is returned when no argument is passed in. Otherwise, an integer value is returned as the stride in the particular dimension :attr:‚Äôdim‚Äô. Args:  dim (int, optional): the desired dimension in which stride is requiredExample::* x = torch. tensor([[1, 2, 3, 4, 5], [6, 7, 8, 9, 10]])`x. stride()&gt;&gt;&gt; (5, 1)x. stride(0)&gt;&gt;&gt; 5x. stride(-1)&gt;&gt;&gt; 1   unsqueeze &amp; None index   We can manipulate rank of tensor Special value ‚ÄòNone‚Äô, which means please squeeze a new axis here== please broadcast herec = torch. tensor([10,20,30])c[None,:] in c, squeeze a new axis in here please. 2. 2 Matmul with broadcasting: for i in range(ar):#  c[i,j] = (a[i,:]).      *[:,j]. sum() #previous  c[i]  = (a[i]. unsqueeze(-1) * b). sum(dim=0) And Using None also (As howard teached)c[i]  = (a[i ]. unsqueeze(-1) * b). sum(dim=0) #howardc[i]  = (a[i][:,None] * b). sum(dim=0) # using Nonec[i]  = (a[i,:,None]*b). sum(dim=0)‚≠êÔ∏èTipsüåü 1) Anytime there‚Äôs a trailinng(final) colon in numpy or pytorch you can delete it ex) c[i, :] = c [i]2) any number of colon commas at the start, you can switch it with the single elipsis.  ex) c[:,:,:,:,i] = c [‚Ä¶,i] 2. 3 Broadcasting Rules:  What if we tensor. size([1,3]) * tensor. size([3,1])?  torch. Size([3, 3])    What is scale????   What if they are one array is times of the other array? ex) Image : 256 x 256 x 3Scale : 128 x 256 x 3Result: ?   Why I did not inserted axis via None, but happened broadcasting? &gt;&gt;&gt; c * c[:,None]tensor([[100. , 200. , 300. ],    [200. , 400. , 600. ],    [300. , 600. , 900. ]])maybe it broadcast cz following array has 3 rows as same principle, no matter what nature shape was, if we do the operation tensor broadcasts to the other. &gt;&gt;&gt; c==c[None]tensor([[True, True, True]])&gt;&gt;&gt; c[None]==c[None,:]tensor([[True, True, True]])&gt;&gt;&gt;c[None,:]==ctensor([[True, True, True]])3. Einstein summation:  Creates batch-wise, remove inner most loop, and replaced it with an elementwise producta. k. ac[i,j] += a[i,k] * b[k,j]inner most loop c[i,j] = (a[i,:] * b[:,j]). sum()elementwise product  Because K is repeated so we do a dot product. And it is torch. Usage of einsum()1) transpose2) diagnalisation tracing3) batch-wise (matmul) ‚Ä¶  einstein summation notationdef matmul(a,b): return torch. einsum('ik,kj-&gt;ij', a, b)so after all, we are now 16000 times faster than Python. 4. Pytorch op: 49166. 67 times faster than pure python And we will use this matrix multiplication in Fully Connect forward, with some initialized parameters and ReLU. But before that, we need initialized parameters and ReLU, Footnote:  TensorRank ti noteResources:  Frobenius Norm Review Broadcasting Review (especially Rule)     Refer colab! (I totally confused with extension of arrays)    torch. allclose Review np. einsum Reviewh "
    }, {
    "id": 13,
    "url": "http://localhost:4000/2020/03/note08-fastai-1/",
    "title": "What is the meaning of 'deep-learning from foundations?'",
    "body": "2020/03/01 - ‚Äù Lecture 08 - Deep Learning From Foundations-part2 ‚Äú I don‚Äôt know if you read this article, but I heartily appreciate Rachael Thomas and Jeremy Howard for providing these priceless lectures for free Homework:  Review concepts 16 concepts from Course 1 (lessons 1 - 7)(1) Affine Functions &amp; non-linearities; 2) Parameters &amp; activations; 3) Random initialization &amp; transfer learning; 4) SGD, Momentum, Adam; 5) Convolutions; Batch-norm; 6) Dropout; 7) Data augmentation; 8) Weight decay; 9) Res/dense blocks; 10) Image classification and regression; 11)Embeddings; 12) Continuous &amp; Categorical variables; 13) Collaborative filtering; 14) Language models; 15) NLP classification; 16) Segmentation; U-net; GANS) Make sure you understand broadcasting Read section 2. 2 in Delving Deep into Rectifiers Try to replicate as much of the notebooks as you can without peeking; when you get stuck, peek at the lesson notebook, but then close it and try to do it yourself calculus for machine learning     based on weight‚Ä¶    einsum conventionCONTENTS:  What is going on in this course?     What is ‚Äòfrom foundations‚Äô?   Steps to a basic modern CNN model   Today‚Äôs implementation goal: 1) matmul -&gt; 4) FC backward    Library development using jupyter notebook     jupyter notebook certainly can make module    Elementwise ops     How can we make python faster?         What is element wise operation?           FootnoteWhat is going on in this course?: What is ‚Äòfrom foundations‚Äô?: 1) Recreate fast. ai and Pytorch 2) using pure python  Evade OverfittingOverfit : validation error getting worsetraining loss &lt; validation loss  Know the name of the symbol you usefind in this page if you don‚Äôt know the symbol that you are using or just draw it here (run by ML!) Steps to a basic modern CNN model:  1) Matrix multiplication -&gt; 2) Relu/Initialization -&gt; 3) Fully-connected Forward-&gt; 4) Fully-connected Backward -&gt; 5) Train loop -&gt; 6) Convolution-&gt; 7) Optimization -&gt;8) Batchnormalization -&gt; 9) Resnet Today‚Äôs implementation goal: 1) matmul -&gt; 4) FC backward: Library development using jupyter notebook: what is assers? jupyter notebook certainly can make module:  There will be #export tag that Howard (and we) want to extract special notebook2script. py will detect sign of #expert and convert following into python module and test ittest\_eq(TEST,'test')test\_eq(TEST,'test1')  what is run_notebook. py?     when you want to test your module in command line interface   		!python run\_notebook. py 01_matmul. ipynb  Is there any difference between 1) and 2)?1) test -&gt; test01 2) test01 -&gt; test #TODO I don‚Äôt know yet  look into run_notebook. py, package fire Jeremy used. What is that?read and run the code in a notebook, and in the process, Jeremy made Python Fire library called!shockingly, fire takes any kind of function and converts into CLI command. fire library was released by Google open source, Thursday, March 2, 2017    Get data   pytorch and numpy are pretty much same.  variable c explains how many pixels there are in in MNIST, 28 pixels PyTorch‚Äôs view() method: torch function that manipulating tensor, and squeeze() in torch &amp; mathmatical operation similar function Rao &amp; McMahan said usually this functions result in feature vector.    In part 1, you can use view function several times.     Initial python model     Which is Linear, like $Xw$(weight)$+a$(bias) $= Y$     If you don‚Äôt know hou to multiple matrix, refer this site matmul visulization site   How many time spends if we we use pure python   function matmul, typical matrix multiplication function, takes about 1 second for calculating 1 single train data! (maybe assumed stochastic, 5 data points in validation)     it takes about 11. 36 hours to update parameters even single layer and 1 iteration! (if that was my computer, it would be 14 hours. . )ü§™   THIS is why we need to consider ‚Äòtime‚Äô&amp;‚Äôspace‚Äô This is kinda slow - what if we could speed it up by 50,000 times? Let‚Äôs try! Elementwise ops: How can we make python faster?:  If we want to calculate faster, then do remove pythonic calcuation, by passing its computation down to something that is written something other than python, like pytorch.  According to PyTorch doc it uses C++ (via ATen), so we are going to implement that function with python. What is element wise operation?:  items makes a pair, operate corresponding componentFootnote:  notebooks material video broadcasting excel"
    }, {
    "id": 14,
    "url": "http://localhost:4000/2020/02/dps-week8/",
    "title": "Digital Product School week 8",
    "body": "2020/02/24 - The 8th week retropect at Digital Product School Week 8 - Ship your MVP     This week's schedule  CONTENT:  Preparing engineering weekly Agile Process, daily stand-up Making application flowchart (feat draw. io)MondayPreparing engineering weekly:  This week at Wednesday, I will explain the Language Modelings, mainly focusing ELMo, ULMFiT, BERT and GPT-2. Slides is available hereAgile Process, daily stand-up:  As always, we did daily stand-up to follow-up our agile process. This daily stand-up helps us to synchronize each part‚Äôs process so that we can save our time when we have to explain our project in charge.     Each color means every different section. Red: Our team goal, Blue: Interaction designer, Green: Product manager, Yellow: Software/AI engineer      This week engineer's main plan  Making application flowchart (feat draw. io):  Before we start the party, we should clarify the flowchart and ER diagram of our application.  Thankfully, we could use draw. io for our flowchart framework. (It can be connected to GCP!)     Following basic of UML diagram was little bit difficult.    Flowchart has rule with the symbols, color, size, space, scaling and direction of arrow   This tutorial helps us a lot to make conventional flowchart       This week engineer's main plan  TuesdayWednesdayThursdayFriday"
    }, {
    "id": 15,
    "url": "http://localhost:4000/2020/02/fast.ai-nlp-note-16/",
    "title": "fast.ai nlp lesson16",
    "body": "2020/02/20 - Algorithms can encode &amp; magnify human bias Case Study 1: Facial Recognition &amp; Predictive Policing:  Joy Buolamwini &amp; Timnit Gebru, gendershades. org     Microsoft, FACE+, IBM - All of these things are sell now.    Largest gap between $\therefore\ Lighter Male\ &gt;\ Darker\ Female $      This US mayor joked cops should ‚Äúmount . 50-caliber‚Äù guns where AI predicts crime      With machine learning, with automation, there‚Äôs a 99% success, so that robot is „Ö°will be„Ö°99% accurate in telling us what is going to happen next, which is really interesting.     - city official in Lancater, CA, approving on using IBM for public security  Bias:  Bias is type of error Statistical Bias: difference between a statistic‚Äôs expected value and the true value Unjust Bias: disproportionate preference for or prejudice against a group Unconscious bias: bias that we don‚Äôt realize we have But, term bias is too generic to be productive. Different sources of bias have different causes Representation Bias: Dataset was not representative of the algorithm that might be used on later. Above : Data is okay, but algorithm has some problem. Below : Data has error.  For example, object detection production that performs very well in common product of US. But in contrast, change of target product region, like Zimbabwe, Solomon Island, and so on, reduced the performence remarkably. It is not the algorithmic problem, so we should care about data volume of region. Evaluation Bias: Benchmark datasets spur on research, 4. 4% of IJB-A images are dark-skinned women. 2/3 of ImageNet images from the West (Sharkar et al, 2017) Case Study 2: Recidivism Algorithm Used Prison Sentencing: Case Study 3: Online Ad Delivery: Bias in NLP: ( Nothing to do with the course, but I‚Äôm researching this field these days. )    But all about Englsih     ImpactThe person is doctor. The person is nurse -&gt; Í∑∏Îäî ÏùòÏÇ¨Îã§. Í∑∏ÎÖÄÎäî Í∞ÑÌò∏ÏÇ¨Îã§.  Concept of ‚Äúbiased data‚Äù often too generic to be useful:  Different sources of bias have different sources Data, models and systems are not unchanging numbers on a screen. They‚Äôre the result of a complex process that starts with years of historical context and involves a series of choices and norms, from data measurement to model evaluation to human interpretation. - Harini Suresh, ‚ÄúThe problem with Biased Data‚Äù Five Sources of Bias in ML:  Representation Bias Evaluation Bias Measurement Bias Aggregation Bias(46:02) Historical Bias(46:26)     A few studies(47:13)   Racial Bias, Even when we have good intentions(new york times)(47:10)   gender(48:59)   Humans are biased, so why does algorithmic bias matter?: Algorithms &amp; humans are used differently (humans are usually decision maker):  Algorithms are accurate and objective No way to apeal if there if error processed large scale cheap Machine learning can amplify bias: Machine learning can create feedback loops. : Technology is power. And with that comes responsibility. : Solutions:  Analyze a project at work/school:     Questions about AI   5 types of bias (Suresh &amp; Guttag)   Datasheets for datasets, Modelcards for model reporting   Accuracy rate on different sub-groups    Work with domain experts &amp; those impacted Increase diversity in our workspace Advocate for good policy Be on the ongoing lookout for bias"
    }, {
    "id": 16,
    "url": "http://localhost:4000/2020/02/classifier-city/",
    "title": "Making a classifier with gooogle img (Cebu / Munich / Seoul)",
    "body": "2020/02/15 - Code can be found here Making a classifier which can distinguish Seoul from Munich and Cebu!(hoping my well in Munich!ü§ü, and I love Cebu) CONTENTS:  1. Creating dataset from google images     1. 1 Using google_images_download   1. 2 Create ImageDataBunch    2. Train model     2. 3 fit_one_cycle()   2. 4 find_rl()    3. Interpretation 4. Cleaning Up 5. Putting your model in production1. Creating dataset from google images: You can use either URLs or google_images_download package. Since Jeremy explained specifically, I will try the other. 1. 1 Using google_images_download: note: This is not google official package Refer to Official Doncument, put that arguments. from google_images_download import google_images_downloadresponse = google_images_download. googleimagesdownload()  #class instantiationout_dir = os. path. abspath('. . /. . /materials/dataset/pkg/')os. mkdir(out_dir)arguments = { keywords : Cebu,Munich,Seoul ,        print_urls :True,        suffix_keywords : city ,        output_directory :out_dir,        type : photo ,      }paths = response. download(arguments)  #passing the arguments to the functionprint(paths)and if you need, here is main code. 1. 2 Create ImageDataBunch: We need to separate validation set because we just grabbed these imagese from Google. Most of the dataset we use (kaggle/research) splited into train / validation / test so if they are not devided beforehand we should make databunch, and Jeremy recommended assign 20% to validation. Help on function verify_images in module fastai. vision. data:verify_images(path: Union[pathlib. Path, str], delete: bool = True, max_workers: int = 4, max_size: int = None, recurse: bool = False, dest: Union[pathlib. Path, str] = '. ', n_channels: int = 3, interp=2, ext: str = None, img_format: str = None, resume: bool = None, **kwargs)  Check if the images in `path` aren't broken, maybe resize them and copy it in `dest`. Data from google image url Data from package 2. Train model:       ¬†   len(class)   len(train)   len(valid)         Data_url   3   432   108       Data_pkg   3   216   53   Uisng model: restnet34 1 , Measurement: accuracy 2 2. 3 fit_one_cycle(): Help on method fit_one_cycle in module fastai. train:fit_one_cycle(cyc_len: int, max_lr: Union[float, Collection[float], slice] = slice(None, 0. 003, None), moms: Tuple[float, float] = (0. 95, 0. 85), div_factor: float = 25. 0, pct_start: float = 0. 3, final_div: float = None, wd: float = None, callbacks: Union[Collection[fastai. callback. Callback], NoneType] = None, tot_epochs: int = None, start_epoch: int = None) -&gt; None method of fastai. basic_train. Learner instance  Fit a model following the 1cycle policy.       ‚Åüepoch‚Åü   ‚Åütrain_loss‚Åü   ‚Åüvalid_loss‚Åü   ‚Åüerror_rate‚Åü   ‚Åütime‚Åü         0   1. 964414   1. 207057   0. 583333   00:04       1   1. 722742   1. 476875   0. 481481   00:02       2   1. 541905   1. 656574   0. 537037   00:02       3   1. 442706   1. 680708   0. 546296   00:02          ‚Åüepoch‚Åü   ‚Åütrain_loss‚Åü   ‚Åüvalid_loss‚Åü   ‚Åüerror_rate‚Åü   ‚Åütime‚Åü         0   2. 334755   1. 945266   0. 566038   00:02       1   1. 751931   1. 366638   0. 415094   00:01       2   1. 527215   1. 165065   0. 396226   00:01       3   1. 317051   1. 108083   0. 339623   00:01   2. 4 find_rl(): This section you should find the strongest downward slope that kind of sticking around for quite a while. (to be continued to the other lectures) 3. Interpretation: 4. Cleaning Up: 5. Putting your model in production: Reference: How to create a deep learning dataset using Google Images       Deep Residual Learning for Image Recognition¬†&#8617;        Accuracy_and_precision¬†&#8617;    "
    }, {
    "id": 17,
    "url": "http://localhost:4000/2020/02/dps-week5/",
    "title": "Digital Product School week 5",
    "body": "2020/02/09 - The 5th week retropect at Digital Product School Week 5 - Create a Storymap and sync it with Lean Canvas     This week's schedule  CONTENT:  How to create our story map Prepare your story Discover your product‚Äôs AI potentialMondayHow to create our story map:     We need this 'aha' moment  There was a Milestone workshop, about our weekly goal. As we are agile working, we go fast and change every week‚Äôs goal. This week we will finalize our story map based on user‚Äôs pain-point and HMW questions.     How should we make our story-map  Basically we should make story map based on this rule  Tell stories, don‚Äôt just write them!     We always need context, that means all the story component should be connected    Visualize your product to establish a shared understanding and speed up discussions!     Post-it filled of text is not enough, we should fill it with visualizations then team mates can understand it fast    Only discuss in front our your story map! (Speed)     So we can update our story-map as soon as we change our opinion   And also    Use a story map to find the parts that matter most and to identify holes in your idea!     Since the story map consists of techinical part, we should consider each story‚Äôs technical feasibility    Minimise output, maximise outcome and impact! Build tests to figure out what‚Äôs minimum and what‚Äôs viable!     This story map functions to find out our minimum value of ideas    Work iteratively: Change your story map according to your learnings!     We should repeat this process again and again    PMs: Make sure Storymap is up to date!Prepare your story:     team cero, our whole story map    Our goal    Technical feasibility of our storyWhat is your strategy to make user achieve something? This would be our expand point Discover your product‚Äôs AI potential: How can we apply AI to our product? Let‚Äôs write down our ‚ÄòHMW‚Äô questions, and find out all p ossibilities. These are suggestion of possibilities, so don‚Äôt attached to feasibility (we will do in at lean start-up)     Software section's expectation    AI section's expectationTuesday    Engineer's task, week5This 5th week, engineers settled WendesdayThursdayFriday"
    }, {
    "id": 18,
    "url": "http://localhost:4000/2020/02/GPU-time/",
    "title": "4 reasons took much time to setting GPU for fast.ai than I expected",
    "body": "2020/02/05 - Motivation: Before now, me as a undergraduate student, I was parsimony who usually depend on colab, kaggle, friend‚Äôs server(occasional) whenever i need GPU. . And this time it‚Äôs been for a while to install GPU than I expected and I share the several component that stood in my way. Written at Oct 24 2019, if you think this is deprecated, please do not have a leap of faith. Just for the record, I‚Äôve used Kaggle, Colab, GCP, Azure, EC2 as GPU cloud. 1. Did not know there is JupyterLab option in Google Cloud Platform. : At the first time when GCP came out, there was no AI Platform service. So from starting vm instance to launching jupyter and installing packages, I did all of the things myself. (and I learned ü§ó) $	curl -O https://repo. continuum. io/archive/Anaconda3-5. 0. 1-Linux-x86_64. sh[Downloading conda in ssh] I created VM instance,selected zone, machine type and disk type. Then, define firewall rules and in ssh terminal, install jupyter and other packages. But you can do all of these things just using AI Platform.  [AI Platform] I think it especially save your time if you are living in Asia-Pacific, which google doesn‚Äôt support not that much GPU resources.  2. Consider if the platform has limited resources in a region you live in. : I live in South Korea, East Asia, and it seems like this region has lots of limitation in GPU (except quite expensive AWS) And the Taiwan which was the only one region where I can launch my own VM with GPU (I tried all the other regions in the list) sometimes do normaly, but not always. üò•After launching, I did several works and next day I could not start VM. (I didn‚Äôt count it, but tried it a few hours because I didn‚Äôt want cost any more time‚Ä¶) Endlessly failed to start instance, then I choose to move AWS as an alternative way. 3. Fast. ai gives deliberate guide and I didn‚Äôt know it. : Fast. ai offer the guide for all available platform. (Colab, salamander, Gradient, Kaggle, Colab, and so on) It is so important, and really needs, because cloud computing options are vary as occasion and purpose arise. I didn‚Äôt know fast. ai has manual to running GCP, and I think it‚Äôs as good a reason as any for me to be have taken time. It helped me so much when I had aws and shortened my time. I don‚Äôt want to read all of the manual in amazno. . (It is recommended. . but I‚Äôd rather read GIT PRO now‚Ä¶) ssh -i ~/. ssh/&lt;your_private_key_pair&gt; -L localhost:8888:localhost:8888 ubuntu@&lt;your instance IP&gt;4. You should wait to add more volume just after add volume, by building AWS EC2. : Since Elastic Block Store(EBS) storage supports optimized storage, users can‚Äôt extend storage volume two times in a row.  Unfortunately, at the first time, I didn‚Äôt know it (again üëª) and when VM lacked volume, I doubled dist capacity (76*2) at a rough but It needs more.  &lt;!‚Äì this time I installed GPU in two years, and it became little complicated compared to 2 years ago. And this time for the first time(maybe not the first time. . but i handled it in my class or with my friend. but it‚Äôs my first time on my own. ) I very I‚Äôm started to using used google colab, kaggleand, GCP-JupyterLab, ec2 - friend made, aws vm machine but I had a environment variable but i did not know of it. On these days, I could not get a resources from taiwan‚Ä¶    I couldn‚Äôt notice a deliberate     Anyway, as a result I tried myself gcp myself and aws ec2 with fast. ai But I think doing on my self surely takes much time (in this point I wonder why I‚Äôm doing this, and should remind me, especially I was studying disk volume optimization)     disk volume exceed - https://askubuntu. com/questions/919748/no-space-left-on-device-even-though-there-is:  "
    }, {
    "id": 19,
    "url": "http://localhost:4000/2020/02/dps-week4/",
    "title": "Digital Product School week 4",
    "body": "2020/02/01 - The 4th week retropect at Digital Product School Week 4 - Find solution ideas and run experiments   [This week‚Äôs schedule] CONTENT:  Ideation Techniques     What is ideation techniques?    Generating idea in my team AIdeation Team brain storming of idea Die Produkt MacherMondayIdeation Techniques:   [slides from @steffen] What is ideation techniques?: We tried to find out user‚Äôs painpoint last week. Tried to users talk about their, pain point. No question directly, but extract from them their pain with transportation. Generating idea in my team:   AIdeation:   TuesdayTeam brain storming of idea:   Based on generated idea on Monday, we extended our idea doing rolling-paper!     Die Produkt Macher: What is lean start-up?  Lean startup is a methodology for developing businesses and products that aims to shorten product development cycles and rapidly discover if a proposed business model is viable; this is achieved by adopting a combination of business-hypothesis-driven experimentation, iterative product releases, and validated learning. - wikipedia WendesdayThursdayFriday"
    }, {
    "id": 20,
    "url": "http://localhost:4000/2020/01/retrosprect-of-acl-paper-2020/",
    "title": "Retrospect of ACL 2020 paper writing",
    "body": "2020/01/29 - 2020 Annual Conference of the Association for Computational Linguistics Why I can‚Äôt use ‚ÄòCebuano‚Äô for the research?: Why I had to change target language from ‚ÄòCebuano‚Äô to ‚ÄòTagalog‚Äô?-&gt; No language translator options except google translation. But before knowing that I already consult my friend, whose mother tongue is English. So I had to aplogize her, but couldn‚Äôt tell her why suddenly I changed my plan. -&gt; I realized there are many languages even can‚Äôt be researched at all. . -&gt; Getting accustomed to discrimination makes misunderstanding, sometimes. At my country, we couldn‚Äôt use music streaming service, because of legal problem. But at that moment, I thought it was discrimination, which is done by music company. "
    }, {
    "id": 21,
    "url": "http://localhost:4000/2020/01/Git-Merge/",
    "title": "Why am I not listed as a contributor?!",
    "body": "2020/01/10 - From the end of last year, big changes have witnessed in NLP research. Embracing an unprecedented growth, I started to study new exciting results and advances. In doing so, I noticed I‚Äôm not listed as contributor of repo which my PR accessed. How did I come to a repository?: When I‚Äôm stuck, I would prefer to code, than to go deep in theory. (It must be so. . too much to understand ü§í)It was BERT released by Google AI I felt keenly the necessity of implementing, because not only couldn‚Äôt understand the way they figured out positional encoding formula, but how it actually works. What does it mean to ‚Äúscale‚Äù dot product in Attention? (Now I know it‚Äôs far from my section üòÇ) Figure 1. Scaled Dot Product. Adopted from tensorflow blogWhat was the code error?: For implement code in paper, I read the papers Transformer and BERT, structured the model, and refered the others‚Äô code. Meanwhile, I found out a small error in tokenization process, which was changing a token into [MASK], enabled bidirectional representation. I‚Äôve made PR, and got merged. But I was not in contributors. Why?: Figure 2. Merged Pull request Adopted from graykode projectActually I happened to know there can be couple of reasons github doesn‚Äôt include my name as contributor. Well, if contributors tab has more than 100 people, in which case it shows you up only if you are in the top 100 contributors because displaying too many contributors can make webpages down. Somethimes, however, it doesn‚Äôt that problem. Why not? Two possibilities are there.    First, According to Joel-Glovier, if repository maintainer merged-as-a-rebase PR will end up showing as maintainer‚Äôs commit. But maintainer shouldn‚Äôt normally do this.     Second, if you happend to commit using a different git email that what is in your GitHub profile, it will not be attached to your Github user, and ‚Äúdoesn‚Äôt show up‚Äù as you.  Reference:  Micha≈Ç Chromiak‚Äôs blog Github: why are my contributions are not showing on my profile atlassian-gitfetch"
    }, {
    "id": 22,
    "url": "http://localhost:4000/2019/12/lesson1-fastai/",
    "title": "Fine Grained Classification",
    "body": "2019/12/31 - Finally you can solve the mystery behind this weird drawing. . through this course. juptyer notebook magic: %reload_ext autoreload%autoreload 2%matplotlib inlinethis is special directives to jupyter notebook, not python code. And it is called ‚Äòmagics‚Äô (but i think jeremy is magicion)  If somebody changes underlying library code while I‚Äôm running this, please reload it automatically If somebody asks to plot something, then please plot it here in this Jupyter NotebookDon‚Äôt hesitate to import start~ Digging into untar_data, path. ls: Union[pathlib. Path, str]: typed programming language? -&gt; maybe i think disclaim the type beforehand for sure.  Q. like assert? path. ls()this is some module that fast. ai made because os. listdir(‚Äòpath‚Äô) is unconvinient. Python3 pathlib library!: pathlib "
    }, {
    "id": 23,
    "url": "http://localhost:4000/2019/12/what-is-convolution/",
    "title": "fast.ai lesson08",
    "body": "2019/12/16 - This is the part of Journey which Jeremy recommended us to do. One of the concepts I have to know. 1) Kaiming Initializtion in Pytorch was in trouble. 12) Jeremy started to dig in, in lesson09, but I didn‚Äôt know why the size of tensor is 2 and even understand this spreadsheet data. 3 Homework: Read Visualizing and Understanding Convolutional Networks paper  What is a convolution?     Visualization         one kernel     Matthew D Zeiler &amp; Rob Fergus Paper          Convolution can be represented as matmul   Padding   Kernel has rank 3   How can we find a side-edge, a gradient and area of constant weight?   What is a convolution?: A convolutional neural network is that your red, green, and blue pixels go into the simple computation, and something comes out of that, and then the result of that goes into a second layer, and the result of that goes into the third layer and so forth. Visualization: one kernel Refer this site for visualizing CNN filteringMatthew D Zeiler &amp; Rob Fergus PaperLecture01 {align-items: center;}  nine examples of the actual coefficients from the first layer. Convolution can be represented as matmul: CNNs from different viewpoints {align-items: center;}    [A B C D E F G H I J] is 3 by 3 image data flatten to vector.   As a result, convolution is a just matrix just two things happens     Some of entries are set to zeros at all the times   same color always have the same weight. That called weight time / wegith sharing    So, we can implement a convolution with matrix multiplication. But, we don‚Äôt do that because it‚Äôs slow!Padding:  What most of libraries do is just put zeros asdie of matrix  fast. ai uses reflection paddings (what is this? Jeremy said he uttered it)Kernel has rank 3:  As standard picture input would be 4 5, it would be actually 3d, not 2d.  If we make kernel as a 3x3 size, we pass over same kernel all the different Red, Green, Blue Pixels.      This could make problem, because, if we want to detect frog, which is green, we would want more activations on the green(I made a test cell in my colab 6)   How can we find a side-edge, a gradient and area of constant weight?: Not top-edge!  One kernel can find only the top-edge, so we should stack the kernels 7 So, we pass it through bunch of kernels to the input images, and that process gives us height x width x corresponding number of kernels.  Usually that number of chanel is 16 And if we want to get the more channels and features, we should repeat that process     This process gives rise to memory out of control, we do the stride   #### conv-example. xlsx  2 convolutional filters At a second layer, filter is 3x3x2 tensor, because to add up together the first layer‚Äôs channel. Reference:       Problem was math. sqrt(5) was not kaiming initialization formula, Implementation in Pytorch¬†&#8617;        size of tensor, lecture09¬†&#8617;        conv-example. xlsx¬†&#8617;        Why do computer use red, green and blue instead of primary colors¬†&#8617;        Grayscale is a group of shades without any visible color. ‚Ä¶ Each of these dots has its own brightness level as well and, therefore, can be converted to grayscale. A grayscale image is one with all color information removed. ¬†&#8617;        Testing RGB and grayscale¬†&#8617;        stack kernel and make new rank of tensor at output, Lesson06-2019¬†&#8617;    "
    }, {
    "id": 24,
    "url": "http://localhost:4000/2019/12/jeremy-howard/",
    "title": "Jeremy Howard",
    "body": "2019/12/15 - This is journey to find out ‚Äòwho am I trying to be?‚Äô: How he impacted me?  The person who made me start Computer Vision again. He emphasized the importance of studying NLP and Computer together to understand the deep-learning. He didn‚Äôt order it to study, but always he pursuade me with reasonable way.  ‚ÄúIt‚Äôs not just something I can throw away. NLP and computer vision a few weeks apart and that‚Äôs going to force your brain to realize like ‚Äòoh I have to remember this‚Äô‚Äù  He made me admit my failure in deep-learning. I started to objectify where am I. What should I do when I‚Äôm frustrated.  ‚ÄúKeep going. You‚Äôre not expected to remember everything. Yet.  You‚Äôre not expected to understand everything. Yet. You‚Äôre not expected to know why everything works.  Yet. ‚Äù  His articles are numerous, below.      What is torch. nn Really?   High Performance Numeric Programming with Swift: Explorations and Reflections   C++11, random distributions, and Swift    And especially, I like this book. Designing great data products Great predictive modeling is an important part of the solution, but it no longer stands on its own; as products become more sophisticated, it disappears into the plumbing. Designing great data products And he is also famous for words. Here are some.  we‚Äôre going to try and use that to really understand what‚Äôs going on. So to warn you, none of it is rocket science but a lot of its going to look really new. So don‚Äôt expect to get it the first time but expect to listen and jump into the notebook try a few things test things out look particularly at like tensor shapes and inputs and outputs to check your understanding then go back and listen again. But and kind of try it, a few times, because you will get there right, it‚Äôs just that there‚Äôs going to be a lot of new concepts because we haven‚Äôt done that much stuff in pure Pytorch. Lesson 6: Deep Learning 2019 "
    }, {
    "id": 25,
    "url": "http://localhost:4000/2019/11/julia-evans/",
    "title": "Julia Evans",
    "body": "2019/11/20 - This is journey to find out ‚Äòwho am I trying to be?‚Äô: The women who surprised me in many ways. First, she approached me to teaching some concepts drawing cartoons. It was at Hackers news, which was hightest ranks. Personally I have the use of not to reading title, so and cartoon was so cute and clear. I naturally gonna understood mechanism and astonished by her explaination ability. Her value, which she was taught by many people so want to do same things, moved me. Volume of her knowledge, that just reading post title is a deal of work, amazed me. "
    }, {
    "id": 26,
    "url": "http://localhost:4000/2019/11/coc-retropective/",
    "title": "Retrospective on Pycon 2019 Korea (CoC Committee)",
    "body": "2019/11/05 - When I was volunteer, it seems like busy and hectic to managing that crowded conference. In my experience, to get things moving, it needs hierarchy. But it didn‚Äôt. Organizers emphasized our responsibility, and if I passed each other‚Äôs burden, It could be my burden next time. In solidarity of the obligation, we finished conference well. And after participating PyCon Korea 2018 as volunteer, I‚Äôve joined PyCon Korea Organizer last year. &lt;Figure 1&gt; First meeting of PyCon 2019 Korea Organizers It‚Äôs been a while since PyCon 2019 finished. It‚Äôs held on Aug 15 - 18, at Coex Grand Balloom &lt;Figure 2&gt; Ongoing session, speaking on news comment processing &lt;Figure 3&gt; Sponsor Booth iin Coex Hall &lt;Figure 4&gt; After PyCon 2019, with all of volunteer, organizer, speakers üòç ü•∞  Serving as part of the coc TF, I spent large fraction of last year doing CoC job. here‚Äôs the path what we‚Äôve been grappled with to grasp a solution. First half: Before the conference Toward Diverse Community:  Formally we‚Äôve been reusing and modifying PyCon US CoC, but we needed fit in Korean and I was part of that to revise code of conduct. Except ‚ÄòThat‚Äô Diversity, Because it is ‚ÄòHarassment‚Äô:  Specific point was harassment, and the others were not. process of finding the points. How can we settle this point?Second half: During the conference Handling the potential Harassment: Disjunction of policy and real-time situation: This ‚ÄòPyCon 2019 Korea retrospective series‚Äô would be devided into 3 Episodes.  ‚ÄúRetrospective on Pycon 2019 Korea (CoC Committee)‚Äù ‚ÄúRetrospective on Pycon 2019 Korea (Program Chair)‚Äù (20 Nov, To Be Update) ‚ÄúMaintaining participation while still making timely decisions‚Äù (29 Nov, To Be Update)"
    }, {
    "id": 27,
    "url": "http://localhost:4000/2019/11/elif-shafak/",
    "title": "Elif Shafak",
    "body": "2019/11/05 - This is journey to find out ‚Äòwho am I trying to be?‚Äô: For creative-minded people, Istanbul is a treasure. ‚Äô Photo ¬© Chris Boland, licensed under CC BY-NC-ND 2. 0    it suddenly felt like what I was trying to convey was more complicated and detailed than what the circumstances allowed me to say.     And I did what I usually do in similar situations: I stammered, I shut down, and I stopped talking. I stopped talking because the truth was complicated, even though I knew, deep within, that one should never, ever remain silent for fear of complexity.         &lt;Figure 1&gt; Elif Shafak   Photo credit: www. elifsafak. com. tr      I want to talk about emotions and the need to boost our emotional intelligence. I think it‚Äôs a pity that mainstream political theory pays very little attention to emotions.     Oftentimes, analysts and experts are so busy with data and metrics that they seem to forget those things in life that are difficult to measure and perhaps impossible to cluster under statistical models. But I think this is a mistake, for two main reasons. We are emotional beings.     I think it‚Äôs going to be one of our biggest intellectual challenges, because our political systems are replete with emotions. In country after country, we have seen illiberal politicians exploiting these emotions. And yet within the academia and among the intelligentsia, we are yet to take emotions seriously. I think we should.  1 2 Reference:       British Council Worldwide¬†&#8617;        Ted Talk¬†&#8617;    "
    }, {
    "id": 28,
    "url": "http://localhost:4000/2019/01/dps-week3/",
    "title": "Digital Product School week 3",
    "body": "2019/01/25 - The 3th week retropect at Digital Product School Week 3 - Define your How-might-we question   [This week‚Äôs schedule] CONTENT: "
    }, {
    "id": 29,
    "url": "http://localhost:4000/2019/01/dps-week1/",
    "title": "Digital Product School week 1",
    "body": "2019/01/11 - The 1th week retropect at Digital Product School [This week‚Äôs schedule] CONTENT:  Welcome to Digital Product School!     Trip to Spitzingsee   Welcome to Design Office   Specifying our goal of product   Welcome to Digital Product School!: Trip to Spitzingsee:    At the first day of Digital Product School, we had a off-site with all of batch 9 people. All the costs were managed by dps. At the beautiful mountain, we settled the team, and got my team goal.     Basically, there are two kind of team in DPS. (1) Wild team - the team has fixed topic(2) Company team - the team which has specific stakeholders, and also topic defined by that stakeholders  The Core-team will fix what team you will join in DPS for 3 months based on ymy professionals, they announce it at off-site. [My team for 3 months at DPS]    And we decide on my batch #9 theme song. How? Each team draw for songs and pitch ‚Äòwhy this song should be batch #9 theme song‚ÄôThe result? Imagine dragon - Believer (I didn‚Äôt know at the moment, this song would be stamped in my memory)     We have a workshop for getting to know each other. For example, we share 1) what do I expect from 3 months of dps, 2) when I feel happy in my life time, 3) what I worked for last week, 4) what was my last project and 5) what plays important role in my life      My team's board  Cero  Welcome to Design Office:  At first day of design office, we had workshop, which celebrates my day in dps also discuss specific rule, menifesto and stakeholders    We get sticker and attach it in map depends on my nationality  Now time to get to know my team‚Äôs stakeholders. What they want for us? What they expect from us? How free my team are on the topic?To be honest, it is endless tug-of-war. We should discuss with my stakeholders, endlessly, and find out solution which can meet interest of users, stakeholders and my team. Basically, my team‚Äôs main stakeholder is ADAC, but BMW, City of munich and Nokia will also participate as my team‚Äôs stakeholders. Specifying our goal of product: "
    }];

var idx = lunr(function () {
    this.ref('id')
    this.field('title')
    this.field('body')

    documents.forEach(function (doc) {
        this.add(doc)
    }, this)
});


    
function lunr_search(term) {
    $('#lunrsearchresults').show( 1000 );
    $( "body" ).addClass( "modal-open" );
    
    document.getElementById('lunrsearchresults').innerHTML = '<div id="resultsmodal" class="modal fade show d-block"  tabindex="-1" role="dialog" aria-labelledby="resultsmodal"> <div class="modal-dialog shadow-lg" role="document"> <div class="modal-content"> <div class="modal-header" id="modtit"> <button type="button" class="close" id="btnx" data-dismiss="modal" aria-label="Close"> &times; </button> </div> <div class="modal-body"> <ul class="mb-0"> </ul>    </div> <div class="modal-footer"><button id="btnx" type="button" class="btn btn-secondary btn-sm" data-dismiss="modal">Close</button></div></div> </div></div>';
    if(term) {
        document.getElementById('modtit').innerHTML = "<h5 class='modal-title'>Search results for '" + term + "'</h5>" + document.getElementById('modtit').innerHTML;
        //put results on the screen.
        var results = idx.search(term);
        if(results.length>0){
            //console.log(idx.search(term));
            //if results
            for (var i = 0; i < results.length; i++) {
                // more statements
                var ref = results[i]['ref'];
                var url = documents[ref]['url'];
                var title = documents[ref]['title'];
                var body = documents[ref]['body'].substring(0,160)+'...';
                document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML + "<li class='lunrsearchresult'><a href='" + url + "'><span class='title'>" + title + "</span><br /><small><span class='body'>"+ body +"</span><br /><span class='url'>"+ url +"</span></small></a></li>";
            }
        } else {
            document.querySelectorAll('#lunrsearchresults ul')[0].innerHTML = "<li class='lunrsearchresult'>Sorry, no results found. Close & try a different search!</li>";
        }
    }
    return false;
}
</script>
<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>




<form class="bd-search hidden-sm-down" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
<input type="text" class="form-control text-small"  id="lunrsearch" name="q" value="" placeholder="Type keyword and enter..."> 
</form>
            </ul>
        </div>
    </div>
    </nav>

    <!-- Search Results -->
    <div id="lunrsearchresults">
        <ul class="mb-0"></ul>
    </div>

    <!-- Content -->
    <main role="main" class="site-content">
        

<div class="container">
<div class="jumbotron jumbotron-fluid mb-3 pl-0 pt-0 pb-0 bg-white position-relative">
		<div class="h-100 tofront">
			<div class="row  justify-content-between ">
				<div class=" col-md-6  pr-0 pr-md-4 pt-4 pb-4 align-self-center">
					<p class="text-uppercase font-weight-bold">
                        <span class="catlist">
						
                          <a class="sscroll text-danger" href="/categories.html#fast.ai-v3">fast.ai-v3</a><span class="sep">, </span>
                        
                        </span>
					</p>
					<h1 class="display-4 mb-4 article-headline">What's inside Pytorch Operator?</h1>
					<div class="d-flex align-items-center">
                        
						<small class="ml-3">  <span><a target="_blank" href="" class="btn btn-outline-success btn-sm btn-round ml-1">Follow</a></span>
                            <span class="text-muted d-block mt-1">Mar 02, 2020 ¬∑ <span class="reading-time">
  
  
    9 mins read
  
</span>
    </span>
						</small>
					</div>
				</div>
                
				<div class="col-md-6 pr-0 align-self-center">
					<img class="rounded" src="/assets/images/30.png" alt="What's inside Pytorch Operator?">
				</div>
                
			</div>
		</div>
	</div>
</div>





<div class="container-lg pt-4 pb-4">
	<div class="row justify-content-center">
        
        
        <!-- Share -->
		<div class="col-lg-2 pr-4 mb-4 col-md-12">
			<div class="sticky-top sticky-top-offset text-center">
				<div class="text-muted">
					Share this
				</div>
				<div class="share d-inline-block">
					<!-- AddToAny BEGIN -->
					<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
						<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
						<a class="a2a_button_facebook"></a>
						<a class="a2a_button_twitter"></a>
					</div>
					<script async src="https://static.addtoany.com/menu/page.js"></script>
					<!-- AddToAny END -->
				</div>
			</div>
		</div>
        
        
		<div class="col-md-12 col-lg-10">
            
            <!-- Article -->
			<article class="article-post">                
			<h2 id="whats-inside-pytorch-operator">What‚Äôs inside Pytorch Operator?</h2>

<p>Section02</p>

<h3 class="no_toc" id="time-comparison-with-pure-python">Time comparison with pure Python</h3>

<ul>
  <li>
    <p>Matmul with broadcasting<br />
&gt; 3194.95 times faster</p>
  </li>
  <li>
    <p>Einstein summation<br />
&gt; 16090.91 times faster</p>
  </li>
  <li>
    <p>Pytorch‚Äôs operator<br />
&gt; 49166.67 times faster</p>
  </li>
</ul>

<h3 id="1-elementwise-op">1. Elementwise op</h3>

<h4 id="11-frobenius-norm">1.1 Frobenius norm</h4>

<p><img src="/assets/images/7.png" alt="" /> <br /></p>

<ul>
  <li>above converted into <br /></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
</code></pre></div></div>

<ul>
  <li>Plus, don‚Äôt suffer from mathmatical symbols. He also copy and paste that equations from wikipedia.</li>
  <li>and if you need latex form, download it from archive.</li>
</ul>

<h3 id="2-elementwise-matmul">2. Elementwise Matmul</h3>

<ul>
  <li>What is the meaning of elementwise?</li>
  <li>
    <p>We do not calculate each component. But all of the component at once. Because, length of column of A and row of B are fixed.</p>
  </li>
  <li>How much time we saved?</li>
</ul>

<p><img src="/assets/images/4.png" alt="" /></p>

<ul>
  <li>So now that takes 1.37ms. We have removed one line of code and it is a 178 times faster‚Ä¶</li>
</ul>

<p>#TODO
I don‚Äôt know where the <code class="highlighter-rouge">5</code> from. but keep it.
Maybe this is related with frobenius norm‚Ä¶?
as a result, <strong>the code before</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ac</span><span class="p">):</span>
    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</code></pre></div></div>

<p>the code after<br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<p>To compare it (result betweet <em>original</em> and <em>adjusted</em> version) we use not test_eq but other function. The reason for this is that due to rounding errors from math operations, matrices may not be exactly the same. As a result, we want a function that will ‚Äúis a equal to b <strong>within some tolerance</strong>‚Äù</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#export
</span><span class="k">def</span> <span class="nf">near</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> 
    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_near</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> 
    <span class="n">test</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">near</span><span class="p">)</span>

<span class="n">test_near</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">matmul</span><span class="p">(</span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">))</span>
</code></pre></div></div>

<h3 id="3-broadcasting">3. Broadcasting</h3>

<ul>
  <li>Now, we will use the broadcasting and remove</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<ul>
  <li>How it works?</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">]])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="o">=</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,])</span>
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span>
    
<span class="p">(</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">]]),</span>
<span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
         
</code></pre></div></div>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>

<span class="n">tensor</span><span class="p">([[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">]])</span>

</code></pre></div></div>
<p><img src="/assets/images/3.png" alt="" /></p>
<ul>
  <li>&lt;Figure 2&gt; demonstrated how array <strong>b</strong> is broadcasting(or copied but not occupy memory) to compatible with <strong>a</strong>. <em>Refered from <a href="https://www.tutorialspoint.com/numpy/numpy_broadcasting.htm">numpy_tutorial</a></em></li>
</ul>

<ul>
  <li>
    <p>there is no loop, but it seems there is exactly the loop.</p>
  </li>
  <li>
    <p>This is not from jeremy (actually after a moment he cover it) but i wondered How to broadcast an array by columns?</p>
  </li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="o">=</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">a</span><span class="o">+</span><span class="n">c</span>
</code></pre></div></div>

<p><em>tensor([[11, 11, 11],
        [22, 22, 22],
        [33, 33, 33]])</em>s</p>

<hr />

<ul>
  <li>What is tensor.stride()?</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">help</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">stride</span><span class="p">)</span>
</code></pre></div></div>

<p><em>Help on built-in function stride:<br />
    stride(‚Ä¶) method of torch.<br />
Tensor instance<br />
stride(dim) -&gt; tuple or int<br />
Returns the stride of :attr:‚Äôself‚Äô tensor.<br />
Stride is the jump necessary to go from one element to the next one in the specified dimension :attr:‚Äôdim‚Äô.<br />
A tuple of all strides is returned when no argument is passed in.<br />
Otherwise, an integer value is returned as the stride in the particular dimension :attr:‚Äôdim‚Äô.<br /></em></p>

<p>Args:
    dim (int, optional): the desired dimension in which stride is required
Example::*</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span><span class="err">`</span>
<span class="n">x</span><span class="o">.</span><span class="n">stride</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">5</span>
<span class="n">x</span><span class="o">.</span><span class="n">stride</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span>
</code></pre></div></div>

<ul>
  <li>
    <p>unsqueeze &amp; None index</p>
  </li>
  <li>We can manipulate rank of tensor</li>
  <li>Special value ‚ÄòNone‚Äô, which means please squeeze a new axis here<br />
<strong>== please broadcast here</strong></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
<span class="n">c</span><span class="p">[</span><span class="bp">None</span><span class="p">,:]</span>
</code></pre></div></div>

<ul>
  <li>in c, <em>squeeze a new axis in here please.</em></li>
</ul>

<h4 id="22-matmul-with-broadcasting">2.2 Matmul with broadcasting</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ar</span><span class="p">):</span>
<span class="c1">#   c[i,j] = (a[i,:]).          *[:,j].sum() #previous
</span>    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li>And Using <code class="highlighter-rouge">None</code> also (As howard teached)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span>  <span class="p">]</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#howard
</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][:,</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># using None
</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>   <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,:,</span><span class="bp">None</span><span class="p">]</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>‚≠êÔ∏èTipsüåü  <br />
1) <em>Anytime there‚Äôs a trailinng(final) colon in numpy or pytorch you can delete it</em>
  <em>ex) c[i, :] = c [i]</em>
2) any number of colon commas at the start, you can switch it with the single elipsis.
  <em>ex) c[:,:,:,:,i] = c [‚Ä¶,i]</em></p>

<h4 id="23-broadcasting-rules">2.3 Broadcasting Rules</h4>

<ul>
  <li>What if we <code class="highlighter-rouge">tensor.size([1,3]) * tensor.size([3,1])</code>?
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</code></pre></div>    </div>
  </li>
  <li>What is scale????</li>
  <li>
    <p>What if they are one array is <code class="highlighter-rouge">times</code> of the other array?
 <br /> ex) 
<code class="highlighter-rouge">Image : 256 x 256 x 3</code><br />
<code class="highlighter-rouge">Scale : 128 x 256 x 3</code><br />
<code class="highlighter-rouge">Result: ?</code></p>
  </li>
  <li>Why I did not inserted axis via None, but happened broadcasting? <br /></li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">*</span> <span class="n">c</span><span class="p">[:,</span><span class="bp">None</span><span class="p">]</span>
<span class="n">tensor</span><span class="p">([[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">200.</span><span class="p">,</span> <span class="mf">300.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">200.</span><span class="p">,</span> <span class="mf">400.</span><span class="p">,</span> <span class="mf">600.</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">300.</span><span class="p">,</span> <span class="mf">600.</span><span class="p">,</span> <span class="mf">900.</span><span class="p">]])</span>
</code></pre></div></div>

<p>maybe it broadcast cz following array has 3 rows<br /></p>

<p>as same principle, no matter what nature shape was, <em>if we do the operation</em> tensor broadcasts to the other.<br /></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">==</span><span class="n">c</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span>
<span class="n">tensor</span><span class="p">([[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">]])</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="p">[</span><span class="bp">None</span><span class="p">]</span><span class="o">==</span><span class="n">c</span><span class="p">[</span><span class="bp">None</span><span class="p">,:]</span>
<span class="n">tensor</span><span class="p">([[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">]])</span>

<span class="o">&gt;&gt;&gt;</span><span class="n">c</span><span class="p">[</span><span class="bp">None</span><span class="p">,:]</span><span class="o">==</span><span class="n">c</span>
<span class="n">tensor</span><span class="p">([[</span><span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="bp">True</span><span class="p">]])</span>
</code></pre></div></div>

<h3 id="3-einstein-summation">3. Einstein summation</h3>

<p><img src="/assets/images/this-is-einsum.jpg" alt="" /></p>

<ul>
  <li>Creates batch-wise, remove inner most loop, and replaced it with an elementwise product
a.k.a</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>
</code></pre></div></div>
<p>inner most loop</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">*</span> <span class="n">b</span><span class="p">[:,</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<p>elementwise product</p>

<ul>
  <li>Because K is repeated so we do a dot product. And it is torch.</li>
</ul>

<p>Usage of <a href="https://pytorch.org/docs/stable/torch.html#torch.einsum">einsum()</a>
1) transpose
2) diagnalisation tracing
3) batch-wise (matmul)</p>

<p>‚Ä¶</p>

<ul>
  <li>einstein summation notation</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">matmul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s">'ik,kj-&gt;ij'</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</code></pre></div></div>

<p>so after all, we are now 16000 times faster than Python.</p>

<h3 id="4-pytorch-op">4. Pytorch op</h3>

<p>49166.67 times faster than pure python</p>

<p>And we will use this matrix multiplication in Fully Connect forward, with some initialized parameters and ReLU.</p>

<p>But before that, we need initialized parameters and ReLU,</p>

<hr />

<h4 id="footnote">Footnote</h4>

<ul>
  <li><a href="http://mathworld.wolfram.com/TensorRank.html">TensorRank</a></li>
  <li><a href="https://forums.fast.ai/t/forum-markdown-notes-lesson-8/41896">ti note</a></li>
</ul>

<h2 id="resources">Resources</h2>

<ul>
  <li>Frobenius Norm Review</li>
  <li>Broadcasting Review (especially <em><a href="https://docs.scipy.org/doc/numpy-1.13.0/user/basics.broadcasting.html#general-broadcasting-rules">Rule</a></em>)
    <ul>
      <li>Refer <a href="https://render.githubusercontent.com/view/ipynb?commit=2bfe4a95aac864b23bd0c0729d2720c92e169f8c&amp;enc_url=68747470733a2f2f7261772e67697468756275736572636f6e74656e742e636f6d2f5370656c6c4f6e596f752f646c66662d6e6f74652f326266653461393561616338363462323362643063303732396432373230633932653136396638632f6e62732f646c322f30315f6d61746d756c5f70726163746963652e6970796e62&amp;nwo=SpellOnYou%2Fdlff-note&amp;path=nbs%2Fdl2%2F01_matmul_practice.ipynb&amp;repository_id=221963162&amp;repository_type=Repository#Broadcasting">colab!</a> (I totally confused with extension of arrays)</li>
    </ul>
  </li>
  <li>torch.allclose Review</li>
  <li><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.einsum.html">np.einsum Review</a></li>
</ul>

<p>h</p>
                
			</article>
			
			<!-- Tags -->
			<div class="mb-4">
				<span class="taglist">
				
				  <a class="sscroll btn btn-light btn-sm font-weight-bold" href="/tags.html#feature">feature</a>
				
				</span>
			</div>
 
            <!-- Mailchimp Subscribe Form -->
            
            
<!-- TODO: all of author mal funciton -->            
             <!-- Author Box -->
                	
<!-- 				<div class="row mt-5">
					<div class="col-md-2 align-self-center">
                          
					</div>
					<div class="col-md-10">		
                        <h5 class="font-weight-bold">Written by  </h5>
											
					</div>
				</div>				 -->
                
            
            <!-- Comments -->
            
                <!--  Don't edit anything here. Set your disqus id in _config.yml -->

<div id="comments" class="mt-5">
    <div id="disqus_thread">
    </div>
    <script type="text/javascript">
        var disqus_shortname = 'dionne'; 
        var disqus_developer = 0;
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = window.location.protocol + '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>
    Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
</div>
            
            
		</div>
        
        
	</div>
</div>


<!-- Aletbar Prev/Next -->
<div class="alertbar">
    <div class="container">
        <div class="row prevnextlinks small font-weight-bold">
          
            <div class="col-md-6 rightborder pl-0">
                <a class="text-dark" href="/2020/03/note08-fastai-1/"> <img height="30px" class="mr-1" src="/assets/images/1-matmul.png">  What is the meaning of 'deep-learning from foundations?'</a>
            </div>
          
          
        </div>
    </div>
</div>

    </main>


    <!-- Scripts: popper, bootstrap, theme, lunr -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

    <script src="/assets/js/theme.js"></script>


    <!-- Footer -->
    <footer class="bg-white border-top p-3 text-muted small">
        <div class="container">
        <div class="row align-items-center justify-content-between">
            <div>
                <span class="navbar-brand mr-2 mb-0"><strong>SpellOnYou</strong></span>
                <span>Copyright ¬© <script>document.write(new Date().getFullYear())</script>.</span>

                <!--  Github Repo Star Btn-->
                <a class="text-dark ml-1" target="_blank" href="https://github.com/spellonyou"><i class="fab fa-github"></i> VisitMe</a>

            </div>
            <div>
                Made with <a target="_blank" class="text-dark font-weight-bold" href="https://www.wowthemes.net/mundana-jekyll-theme/"> Mundana Jekyll Theme </a> by <a class="text-dark" target="_blank" href="https://www.wowthemes.net">WowThemes</a>.
            </div>
        </div>
        </div>
    </footer>

    <!-- All this area goes before </body> closing tag --> 


</body>

</html>
